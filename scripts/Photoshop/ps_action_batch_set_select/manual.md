# Руководство: Интерактивная пакетная обработка (v1.05.03)

## 1. Назначение
Этот скрипт объединяет возможности пакетной обработки файлов и интерактивного выбора экшена. Он может применять указанный экшен Photoshop к одному или нескольким `.psd` файлам в различных режимах.

Скрипт может работать в двух основных сценариях: **автоматическом** и **интерактивном**.

## 2. Основные параметры

### Параметры пакетной обработки
- **Режим работы (`ps_mode`)**: **(Обязательный)** Определяет, какие файлы будут обработаны.
  - `active_document`: Только текущий активный документ.
  - `active_document_folder`: Все `.psd` файлы в папке активного документа.
  - `selected_file`: Только один файл, указанный в `ps_file_path`.
  - `selected_file_folder`: Все `.psd` файлы в папке, где находится файл из `ps_file_path`.
- **Путь к файлу (`ps_file_path`)**: Используется режимами `selected_file` и `selected_file_folder`.
- **Рекурсивный поиск (`ps_recursive`)**: Поиск во вложенных папках (для режимов `..._folder`).

### Параметры выбора экшена
- **Имя набора экшенов (`ps_action_set`)**: **(Необязательный)**
- **Имя экшена (`ps_action_name`)**: **(Необязательный)**

## 3. Сценарии работы

### Сценарий 1: Интерактивный режим (рекомендуемый)
Этот режим используется, когда вы **не указываете** параметры `ps_action_set` и `ps_action_name`.

1.  Запустите скрипт, указав только параметры пакетной обработки (например, `ps_mode`).
2.  На экране появится диалоговое окно со списком всех ваших наборов экшенов.
3.  Выберите нужный набор. Справа появится список всех экшенов в этом наборе.
4.  Выберите нужный экшен и нажмите "ОК" (или дважды кликните по нему).
5.  Скрипт начнет пакетную обработку файлов с использованием выбранного экшена.

**Пример:** Вы хотите применить какой-то экшен ко всем файлам в папке открытого документа.
- **`ps_mode`**: `active_document_folder`
- **`ps_action_set`**: *<не указывать>*
- **`ps_action_name`**: *<не указывать>*

### Сценарий 2: Автоматический режим
Этот режим используется, когда вы **заранее знаете** и указываете точные имена набора и экшена. Диалоговое окно в этом случае не появляется.

**Пример:** Вы хотите автоматически применить экшен "Резкость для веб" из набора "Мои утилиты" к одному конкретному файлу.
- **`ps_mode`**: `selected_file`
- **`ps_file_path`**: `C:\Photos\image_01.psd`
- **`ps_action_set`**: `Мои утилиты`
- **`ps_action_name`**: `Резкость для веб`

## 4. Процесс обработки
1.  Скрипт определяет, нужно ли показывать диалог выбора экшена.
2.  После определения экшена, он формирует список файлов для обработки согласно параметру `ps_mode`.
3.  Если файлы найдены, он в цикле для каждого файла выполняет шаги:
   a. Открывает файл.
   b. Выполняет указанный экшен.
   c. Сохраняет изменения.
   d. Закрывает файл (если он не был изначально активным).
4.  Ошибки при обработке отдельных файлов выводятся в лог, но не прерывают весь процесс.