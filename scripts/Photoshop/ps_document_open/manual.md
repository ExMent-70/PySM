# Руководство по использованию скрипта "Открыть документ" (v1.05.03)

## 1. Назначение

Этот скрипт предназначен для открытия графического файла (например, `.psd`, `.jpg`, `.png`) в приложении Adobe Photoshop.

Скрипт может работать в двух режимах:
1.  **Автоматический:** Если путь к файлу предоставлен, он будет открыт без вмешательства пользователя.
2.  **Интерактивный:** Если путь к файлу не указан, скрипт отобразит стандартное диалоговое окно, в котором пользователь сможет сам выбрать нужный файл.

## 2. Параметры

-   **Путь к файлу** (`ps_file_path`):
    -   **Тип:** Путь к файлу
    -   **Обязательный:** Нет
    -   **Описание:** Полный путь к файлу, который необходимо открыть.
    -   **Поведение:**
        -   **Если путь указан,** скрипт откроет этот файл.
        -   **Если путь НЕ указан,** появится диалоговое окно для выбора файла вручную.

## 3. Логика работы

1.  Скрипт проверяет, был ли предоставлен параметр `Путь к файлу` (`ps_file_path`).
2.  **Если да:**
    -   Скрипт проверяет, существует ли файл по указанному пути.
    -   Затем он подключается к Adobe Photoshop и отдает команду на открытие этого файла.
3.  **Если нет:**
    -   Скрипт проверяет доступность графической библиотеки `PySide6`.
    -   Если она доступна, на экране появляется системное диалоговое окно "Открыть файл".
    -   Если пользователь выбирает файл и нажимает "ОК", скрипт пытается открыть выбранный файл.
    -   Если пользователь нажимает "Отмена", работа скрипта завершается без ошибок.

## 4. Динамическое формирование путей (Шаблоны)

В автоматическом режиме параметр **Путь к файлу** (`ps_file_path`) поддерживает использование плейсхолдеров вида `{имя_переменной}`. При запуске скрипта в среде PyScriptManager, они будут заменены на значения из Контекста Коллекции.

### Пример:
Если в контексте есть переменная `source_psd` со значением `D:\Projects\MyProject\main.psd`, то в параметре скрипта можно указать `{source_psd}`.

## 5. Зависимости

-   Для работы скрипта **обязательно** требуется `photoshop-python-api`.
-   Для работы **интерактивного режима** (диалогового окна) требуется `PySide6`.

## 6. Коды выхода

-   **Код выхода `0` (Успех):**
    -   Файл был успешно открыт.
    -   Пользователь отменил выбор файла в диалоговом окне.
-   **Код выхода `1` (Ошибка):** Произошла ошибка. Это может быть:
    -   Photoshop не запущен или не отвечает.
    -   Указанный файл не найден.
    -   Файл поврежден или имеет неподдерживаемый формат.
    -   Интерактивный режим был вызван, но библиотека `PySide6` не установлена.

    При получении кода `1` выполнение всей цепочки скриптов будет **остановлено**.