# Руководство: Извлечение метаданных из файла (v1.05.03)

## 1. Назначение
Этот скрипт является ключевым инструментом для работы с данными. Его основная задача — прочитать XMP-метаданные из указанного файла изображения (например, `.psd` или `.jpg`) и сохранить их в **Контекст Коллекции** для использования в последующих скриптах.

**Внимание:** Этот скрипт может работать **только** в среде PyScriptManager.

## 2. Логика работы
1.  Скрипт получает путь к файлу и, опционально, список полей для извлечения.
2.  Вызывает внутренний API `pysm_context.get_document_metadata()`.
3.  Этот метод:
    -   Открывает документ в Photoshop.
    -   Читает его XMP-данные.
    -   Извлекает значения для запрошенных полей. Если поля не запрошены, извлекает все доступные.
    -   Сохраняет каждое поле в Контекст как переменную с именем `psd_meta_<ИмяПоля>`.
4.  После выполнения в лог выводится демонстрация доступа к данным и их полный список.

## 3. Параметры
- **Путь к файлу** (`ps_file_path`):
  - **Обязательный:** Да
  - Путь к файлу, из которого нужно прочитать метаданные. Поддерживает шаблоны.

- **Поля для извлечения** (`ps_meta_fields`):
  - **Тип:** Список строк
  - **Обязательный:** Нет
  - Позволяет указать, какие конкретно поля нужно извлечь. Например: `Headline`, `Keywords`.
  - **Если оставить это поле пустым, скрипт попытается извлечь все известные ему поля метаданных.**
  
      "default": [
        "CaptionWriter",
        "Headline",
        "City",
        "State",
        "Country",
        "Source",
        "Instructions",
        "Category",
        "TransmissionReference",
        "Credit",
        "SupplementalCategories",
        "Location",
        "IntellectualGenre",
        "Scene",
        "SubjectCode",
        "Label",
        "Rating",
        "Personality",
        "Description",
        "Copyright",
        "Creator",
        "Keywords"
      ]  

- **Очистить контекст** (`ps_clear_context`):
  - **Тип:** Флаг (Да/Нет)
  - **Обязательный:** Да  
  - Если включен, перед записью новых данных скрипт удалит из контекста все переменные, начинающиеся с `psd_meta_`.