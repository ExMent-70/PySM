# Руководство: Пакетная обработка экшеном (v1.05.03)

## 1. Назначение
Этот универсальный скрипт применяет указанный экшен Photoshop к одному или нескольким `.psd` файлам. Ключевой особенностью является возможность выбора источника файлов с помощью **Режима работы**.

## 2. Основные параметры
- **Режим работы** (`ps_mode`):
  - **Обязательный:** Да
  - Определяет, какие файлы будут обработаны. Подробнее см. ниже.
- **Имя набора экшенов** (`ps_action_set`):
  - **Обязательный:** Да
- **Имя экшена** (`ps_action_name`):
  - **Обязательный:** Да
- **Путь к файлу** (`ps_file_path`):
  - **Обязательный:** Нет
  - Используется режимами `selected_file` и `selected_file_folder`.

## 3. Режимы работы (`ps_mode`)
Это главный параметр, управляющий поведением скрипта.

### `active_document`
- **Что делает:** Обрабатывает **только один** текущий активный документ в Photoshop.
- **Требования:**
  - В Photoshop должен быть открыт активный документ, сохраненный на диске.

### `active_document_folder`
- **Что делает:** Находит папку, в которой сохранен активный документ, и обрабатывает **все `.psd` файлы** в ней.
- **Требования:**
  - В Photoshop должен быть открыт активный документ, сохраненный на диске.
- **Дополнительные параметры:**
  - `ps_recursive`: Включает поиск во вложенных папках.

### `selected_file`
- **Что делает:** Обрабатывает **только один** файл, указанный в параметре `ps_file_path`.
- **Требования:**
  - Параметр `ps_file_path` должен быть заполнен и указывать на существующий `.psd` файл.

### `selected_file_folder`
- **Что делает:** Находит **родительскую папку** файла, указанного в `ps_file_path`, и обрабатывает **все `.psd` файлы** в ней.
- **Требования:**
  - Параметр `ps_file_path` должен быть заполнен и указывать на существующий файл.
- **Дополнительные параметры:**
  - `ps_recursive`: Включает поиск во вложенных папках.

## 4. Процесс обработки
1. Скрипт определяет список файлов в соответствии с выбранным режимом.
2. Если файлы найдены, он в цикле для каждого файла выполняет шаги:
   a. Открывает файл.
   b. Выполняет указанный экшен.
   c. Сохраняет изменения (`Save`).
   d. Закрывает файл. **Исключение:** если обработанный файл был активным в Photoshop в момент запуска скрипта, он останется открытым.
3. Если при обработке файла происходит ошибка, она выводится в лог, и скрипт переходит к следующему файлу.