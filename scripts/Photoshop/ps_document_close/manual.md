# Руководство: Закрыть документ (v1.05.03)

## 1. Назначение
Этот скрипт закрывает документ в Adobe Photoshop. Он может работать как с текущим активным документом, так и с любым другим открытым документом, указанным по имени.

Ключевой особенностью является гибкое управление сохранением изменений перед закрытием.

## 2. Параметры

-   **Имя документа** (`ps_document_name`):
    -   **Тип:** Строка
    -   **Обязательный:** Нет
    -   **Описание:** Точное, чувствительное к регистру имя документа (включая расширение, например, `MyImage.psd`), который вы хотите закрыть.
    -   **Поведение по умолчанию:** Если параметр не указан, скрипт будет работать с **активным** в данный момент документом.

-   **Принудительно закрыть** (`ps_force_close`):
    -   **Тип:** Флаг (Да/Нет)
    -   **Обязательный:** Нет
    -   **Описание:** Если флаг установлен, документ будет закрыт **без сохранения**, все несохраненные изменения будут потеряны. Это аналог нажатия "Не сохранять" в диалоге закрытия.
    -   **Конфликтует** с параметром `Сохранить перед закрытием`.

-   **Сохранить перед закрытием** (`ps_save_on_close`):
    -   **Тип:** Флаг (Да/Нет)
    -   **Обязательный:** Нет
    -   **Описание:** Если флаг установлен, все несохраненные изменения будут сохранены перед закрытием документа. Это аналог нажатия "Сохранить".
    -   **Конфликтует** с параметром `Принудительно закрыть`.

## 3. Логика работы

1.  Скрипт определяет, какой документ закрывать: указанный по имени или активный.
2.  Далее он определяет режим сохранения:
    -   Если включен `ps_force_close`, все изменения будут отменены.
    -   Если включен `ps_save_on_close`, все изменения будут сохранены. **Внимание:** если это новый, никогда не сохранявшийся документ, Photoshop может выдать ошибку, так как не знает, куда сохранять файл.
    -   Если **ни один из флагов не включен (поведение по умолчанию)**, Photoshop сам решит, что делать. Если в документе есть несохраненные изменения, он покажет стандартный диалог "Сохранить изменения?".

3.  Выполняется команда `close` с выбранной опцией.

## 4. Коды выхода
- **0 (Успех):** Документ успешно закрыт или в Photoshop не было открытых документов.
- **1 (Ошибка):** Произошла ошибка (Photoshop не доступен, документ не найден, пользователь нажал "Отмена" в диалоге сохранения и т.д.).