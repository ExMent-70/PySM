INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Логирование настроено.
CRITICAL - Базовый файл конфигурации не найден: 
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Логирование настроено.
CRITICAL - Базовый файл конфигурации не найден: 
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Логирование настроено.
CRITICAL - Базовый файл конфигурации не найден: 
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Логирование настроено.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Применение переопределений: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Применение переопределений конфигурации: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Output/Analysis/_JPG')]
WARNING - Файл со списком детей не найден или не является файлом: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\children.txt
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.7% (Доступно: 110261.7 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Не хватило имен в списке, кластеру 0 (min_num=3049) присвоено имя: Unknown_1
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.7% (Доступно: 110262.0 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.7% (Доступно: 110262.0 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - INFO: Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 13.15 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Логирование настроено.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Применение переопределений: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Применение переопределений конфигурации: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9б\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.7% (Доступно: 110222.4 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.7% (Доступно: 110222.0 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.7% (Доступно: 110222.1 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - INFO: Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.23 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Логирование настроено.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Применение переопределений конфигурации: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9б\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110161.6 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110162.2 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110162.2 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - INFO: Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.19 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Применение переопределений конфигурации: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9б\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.7% (Доступно: 110212.5 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.7% (Доступно: 110212.9 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.7% (Доступно: 110213.0 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - INFO: Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.13 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9б\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.7% (Доступно: 110210.0 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.7% (Доступно: 110209.9 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.7% (Доступно: 110210.6 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - INFO: Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.20 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9б\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.7% (Доступно: 110209.4 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.7% (Доступно: 110211.2 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.7% (Доступно: 110211.2 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - INFO: Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.39 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9б\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110182.6 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110182.6 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110182.6 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - INFO: Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.23 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9б\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110168.5 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110168.4 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110168.4 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - INFO: Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.30 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9б\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110112.2 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110123.9 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110123.9 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - INFO: Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.20 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9б\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110093.8 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110093.6 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110093.5 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - INFO: Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.23 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9б\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110163.5 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110163.4 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110163.4 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
CRITICAL - Критическая ошибка во время выполнения run_full_processing: name 'l' is not defined
Traceback (most recent call last):
  File "D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\main.py", line 331, in run_full_processing
    l#og_callback("=" * 25 + " ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА " + "=" * 25)
    ^
NameError: name 'l' is not defined

CRITICAL - CRITICAL: Критическая ошибка во время выполнения run_full_processing: name 'l' is not defined
Traceback (most recent call last):
  File "D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\main.py", line 331, in run_full_processing
    l#og_callback("=" * 25 + " ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА " + "=" * 25)
    ^
NameError: name 'l' is not defined

INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: НЕУДАЧА
INFO - Время выполнения: 7.31 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9б\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110129.7 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110129.4 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110129.2 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.23 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9б\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110125.0 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110125.4 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110125.5 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.31 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9б\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110200.5 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110200.3 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110200.3 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.26 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9б\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.2% (Доступно: 109575.3 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109575.2 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109575.3 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 12.40 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9б\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9б/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9б\children.txt: 6 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.1% (Доступно: 109810.8 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Наранбат Бужинлхам'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.1% (Доступно: 109810.6 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.1% (Доступно: 109810.6 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9б\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.19 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 14.2% (Доступно: 112233.4 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 14.2% (Доступно: 112233.4 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 14.2% (Доступно: 112233.3 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.84 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 12.3% (Доступно: 114769.8 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 12.3% (Доступно: 114769.7 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 12.3% (Доступно: 114769.8 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 12.74 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 12.7% (Доступно: 114176.0 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 12.7% (Доступно: 114177.5 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 12.7% (Доступно: 114177.5 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.42 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110180.4 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110180.1 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110180.1 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.22 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110149.4 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110149.5 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110149.6 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 8.04 секунд.
INFO - Логгирование настроено. Уровень: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - -------------------- ЭТАП 1: АНАЛИЗ ИЗОБРАЖЕНИЙ И СБОР ДАННЫХ --------------------
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110155.6 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110155.4 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110155.4 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.24 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - -------------------- ЭТАП 2: КЛАСТЕРИЗАЦИЯ И СОПОСТАВЛЕНИЕ --------------------
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.7% (Доступно: 110226.6 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.7% (Доступно: 110226.3 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.7% (Доступно: 110226.3 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.23 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.7% (Доступно: 110223.1 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - -------------------- ЭТАП 3: ОПЦИОНАЛЬНЫЕ ШАГИ --------------------
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.7% (Доступно: 110223.4 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.7% (Доступно: 110223.3 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - ========================= ОБРАБОТКА УСПЕШНО ЗАВЕРШЕНА =========================
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.32 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.9% (Доступно: 109980.9 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.9% (Доступно: 109980.7 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.9% (Доступно: 109980.7 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.21 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.9% (Доступно: 110032.7 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.9% (Доступно: 110032.6 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.9% (Доступно: 110032.6 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - ==================== ЗАВЕРШЕНИЕ РАБОТЫ ====================
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.14 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.9% (Доступно: 110013.3 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.9% (Доступно: 110013.8 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.9% (Доступно: 110013.8 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.16 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - ==================== ЗАПУСК ОБРАБОТКИ ====================
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110159.6 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110159.5 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110159.5 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.14 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110168.8 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110168.9 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110168.9 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.21 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Собрана информация для модели 'gender'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'emotion'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'age'.
INFO - [AttributeAnalyzer] Собрана информация для модели 'eyeblink'.
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110169.4 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110169.1 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110169.1 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.17 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110158.7 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110159.2 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110159.2 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.19 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110167.9 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110168.4 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110168.4 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.28 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4. Загружены модели: 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110158.8 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110159.4 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110159.4 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.34 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4. Загружены модели: 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110132.2 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110132.6 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110132.7 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.19 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4. Загружены модели: 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110135.5 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110135.1 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110135.1 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.29 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4. Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110146.6 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110146.5 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110146.5 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.12 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4. Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110167.1 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110167.8 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110167.9 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.26 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4. Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: gender_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для gender_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: emotion_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для emotion_cnn.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: age_efficientnet_b2.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для age_efficientnet_b2.onnx успешно создана и закэширована.
INFO - [ONNXManager] Создание новой сессии для: eye_blink_cnn.onnx (TensorrtExecutionProvider)
INFO - [ONNXManager] Сессия для eye_blink_cnn.onnx успешно создана и закэширована.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110178.5 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110178.4 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110178.4 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.14 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4. Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.8% (Доступно: 110167.7 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110168.3 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.8% (Доступно: 110168.4 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.23 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4. Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - [ONNXManager] Создание новой сессии для: ['gender', 'emotion', 'age', 'beauty'], eyeblink
INFO - [ONNXManager] Создание новой сессии для: ['gender', 'emotion', 'age', 'beauty'], eyeblink
INFO - [ONNXManager] Создание новой сессии для: ['gender', 'emotion', 'age', 'beauty'], eyeblink
INFO - [ONNXManager] Создание новой сессии для: ['gender', 'emotion', 'age', 'beauty'], eyeblink
INFO - [ONNXManager] Создание новой сессии для: ['gender', 'emotion', 'age', 'beauty'], eyeblink
INFO - [ONNXManager] Создание новой сессии для: ['gender', 'emotion', 'age', 'beauty'], eyeblink
INFO - [ONNXManager] Создание новой сессии для: ['gender', 'emotion', 'age', 'beauty'], eyeblink
INFO - [ONNXManager] Создание новой сессии для: ['gender', 'emotion', 'age', 'beauty'], eyeblink
INFO - [ONNXManager] Создание новой сессии для: ['gender', 'emotion', 'age', 'beauty'], eyeblink
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.0% (Доступно: 109941.7 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.0% (Доступно: 109941.5 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.0% (Доступно: 109941.4 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.22 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4. Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.0% (Доступно: 109925.8 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.0% (Доступно: 109925.6 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.0% (Доступно: 109925.6 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.17 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Определение доступных провайдеров ONNX Runtime...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - Выбран предпочтительный провайдер из конфигурации: TensorrtExecutionProvider
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4. Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 15.9% (Доступно: 109986.9 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.9% (Доступно: 109998.4 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.9% (Доступно: 109998.4 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.11 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4. Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.0% (Доступно: 109852.9 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.0% (Доступно: 109852.8 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.0% (Доступно: 109852.8 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.26 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена из D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\face_config.toml
INFO - Переопределение конфигурации для: ['paths.folder_path', 'paths.output_path', 'paths.children_file', 'logging_level']
INFO - Конфигурация успешно переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4. Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.0% (Доступно: 109871.7 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.0% (Доступно: 109871.4 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.0% (Доступно: 109871.4 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.33 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Флаг task.run_image_analysis_and_clustering: True
INFO - Общее количество шагов прогресса: 4
INFO - INFO: Инициализация основных компонентов...
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4. Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.0% (Доступно: 109868.1 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.0% (Доступно: 109851.9 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.0% (Доступно: 109851.9 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.29 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - Инициализация обработчиков данных лица...
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4. Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: 1
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.1% (Доступно: 109785.4 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.1% (Доступно: 109785.0 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.1% (Доступно: 109785.0 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.17 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4. Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - Всего активировано обработчиков данных лица: [<fc_lib.fc_attribute_analyzer.AttributeAnalyzer object at 0x00000200B9F71790>]
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.2% (Доступно: 109657.5 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109665.6 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109666.3 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.22 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Инициализация (сбор информации о моделях)...
INFO - [AttributeAnalyzer] Готов к работе. Задач для выполнения: 4. Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.2% (Доступно: 109570.0 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109569.8 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109569.8 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.24 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Найдено 6 изображений для обработки
INFO - Инициализация FaceDetector (ленивая)...
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован.
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.2% (Доступно: 109610.7 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109610.5 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109610.5 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.24 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: {image_type_selected}({sorted_list}). Найдено {count} изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.1% (Доступно: 109719.2 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.1% (Доступно: 109719.2 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.1% (Доступно: 109719.1 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.18 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: {image_type_selected}({sorted_list}). Найдено {count} изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.2% (Доступно: 109656.5 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109656.3 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109656.3 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.22 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: {image_type_selected}({sorted_list}). Найдено {count} изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.2% (Доступно: 109653.1 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109652.9 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109652.9 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.10 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.3% (Доступно: 109451.9 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109451.8 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109451.8 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.52 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW
INFO - Поиск файлов с расширениями: ['.arw', '.cr2', '.cr3', '.nef'] в G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW['.arw', '.cr2', '.cr3', '.nef'], Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.3% (Доступно: 109442.8 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109443.2 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109443.2 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.15 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
CRITICAL - Критическая ошибка в FaceProcessor.process_folder: get_message() takes 1 positional argument but 4 were given
Traceback (most recent call last):
  File "D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib\fc_face_processor.py", line 456, in process_folder
    collect_success = self.collect_and_process_images()
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib\fc_face_processor.py", line 193, in collect_and_process_images
    logger.info(get_message("INFO_IMAGES_FOUND", image_type_selected, sorted_list, count))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: get_message() takes 1 positional argument but 4 were given
ERROR - Этап 1: Анализ изображений и сбор данных завершился с ошибкой.
ERROR - ERROR: Этап 1: Анализ изображений и сбор данных завершился с ошибкой.
CRITICAL - Критическая ошибка во время выполнения run_full_processing: Этап 1: Анализ изображений и сбор данных завершился с ошибкой.
Traceback (most recent call last):
  File "D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\main.py", line 223, in run_full_processing
    raise RuntimeError(
RuntimeError: Этап 1: Анализ изображений и сбор данных завершился с ошибкой.

CRITICAL - CRITICAL: Критическая ошибка во время выполнения run_full_processing: Этап 1: Анализ изображений и сбор данных завершился с ошибкой.
Traceback (most recent call last):
  File "D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\main.py", line 223, in run_full_processing
    raise RuntimeError(
RuntimeError: Этап 1: Анализ изображений и сбор данных завершился с ошибкой.

INFO - [ONNXManager] Завершение работы. Освобождение 0 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: НЕУДАЧА
INFO - Время выполнения: 0.00 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
CRITICAL - Критическая ошибка в FaceProcessor.process_folder: get_message() takes 1 positional argument but 4 were given
Traceback (most recent call last):
  File "D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib\fc_face_processor.py", line 463, in process_folder
    collect_success = self.collect_and_process_images()
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib\fc_face_processor.py", line 194, in collect_and_process_images
    get_message
TypeError: get_message() takes 1 positional argument but 4 were given
ERROR - Этап 1: Анализ изображений и сбор данных завершился с ошибкой.
ERROR - ERROR: Этап 1: Анализ изображений и сбор данных завершился с ошибкой.
CRITICAL - Критическая ошибка во время выполнения run_full_processing: Этап 1: Анализ изображений и сбор данных завершился с ошибкой.
Traceback (most recent call last):
  File "D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\main.py", line 223, in run_full_processing
    raise RuntimeError(
RuntimeError: Этап 1: Анализ изображений и сбор данных завершился с ошибкой.

CRITICAL - CRITICAL: Критическая ошибка во время выполнения run_full_processing: Этап 1: Анализ изображений и сбор данных завершился с ошибкой.
Traceback (most recent call last):
  File "D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\main.py", line 223, in run_full_processing
    raise RuntimeError(
RuntimeError: Этап 1: Анализ изображений и сбор данных завершился с ошибкой.

INFO - [ONNXManager] Завершение работы. Освобождение 0 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: НЕУДАЧА
INFO - Время выполнения: 0.00 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки: RAW['.arw', '.cr2', '.cr3', '.nef'], Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.3% (Доступно: 109538.2 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109538.0 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109537.9 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.25 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - --- Шаг 1: Обработка изображений, сбор данных и сохранение эмбеддингов ---
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - --- Шаг 2: Сохранение JSON данных (без эмбеддингов) ---
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.3% (Доступно: 109537.2 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109536.1 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109535.9 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.34 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.2% (Доступно: 109590.7 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109590.7 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109590.8 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.19 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Начинаем обработку папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Данные (без эмбеддингов) добавлены в JsonDataManager (в памяти).
INFO - Сохранение файлов эмбеддингов в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Портретные эмбеддинги (4) и индекс сохранены.
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Групповые эмбеддинги (5) и индекс сохранены.
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.2% (Доступно: 109577.5 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109577.1 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109577.1 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.22 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\portrait_index.json
INFO - Файл индекса эмбеддингов сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings\group_index.json
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.2% (Доступно: 109581.4 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - JSON сопоставлений (группы -> портреты) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_group_to_portrait.json
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - JSON сопоставлений (портреты -> группы) сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109580.9 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109580.7 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.27 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - ========== Запуск кластеризации и сопоставления ==========
INFO - Использование памяти: 16.3% (Доступно: 109513.0 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индексов...
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - --- Кластеризация портретов ---
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109512.8 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109513.5 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.25 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - Использование памяти: 16.3% (Доступно: 109549.5 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4 записей из файла портретов.
INFO - Загружено 2 записей из файла групп.
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109558.0 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.2% (Доступно: 109558.0 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.20 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - Использование памяти: 16.3% (Доступно: 109530.5 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты), 2 (групповые фото).
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Загрузка эмбеддингов и индекса типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 5 эмбеддингов из group_embeddings.npy
INFO - Загружен индекс (5 записей) из group_index.json
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109530.4 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109530.3 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загрузка эмбеддингов и индекса типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings...
INFO - Загружено 4 эмбеддингов из portrait_embeddings.npy
INFO - Загружен индекс (4 записей) из portrait_index.json
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.18 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - Использование памяти: 16.3% (Доступно: 109525.2 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109525.7 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109526.0 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.32 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - Использование памяти: 16.3% (Доступно: 109541.7 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддингов и 4 индексов типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддингов и 5 индексов типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109541.7 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109541.7 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддингов и 4 индексов типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.25 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - Использование памяти: 16.3% (Доступно: 109531.9 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109530.0 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109530.1 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.20 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - Использование памяти: 16.3% (Доступно: 109525.6 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Оба JSON файла успешно сохранены.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109525.7 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - JSON файл портретных данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109525.7 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - JSON файл групповых данных сохранен: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.17 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления портретных данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - Использование памяти: 16.3% (Доступно: 109542.2 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - Сохранение JSON файлов после обновления портретных данных.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - Сохранение JSON файлов после обновления портретных данных.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109542.0 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109542.0 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.14 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - Использование памяти: 16.3% (Доступно: 109549.5 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON после обновления портретных данных...
INFO - Сохранение JSON файлов после обновления данных.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - Сохранение JSON файлов после обновления данных.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109549.9 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109549.9 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.24 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - Использование памяти: 16.3% (Доступно: 109528.6 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Исп. порог сопоставления из конфига: 0.2500
INFO - --- Сопоставление групповых лиц с портретами ---
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - --- Обновление группового JSON совпадениями ---
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - Сохранение JSON файлов после обновления данных.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109528.4 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109528.4 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.32 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - Использование памяти: 16.3% (Доступно: 109523.4 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновление группового JSON информацией о сопоставлениях...
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON после обновления групповых данных...
INFO - Сохранение JSON файлов после обновления данных.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109523.3 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109523.3 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.29 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - Использование памяти: 16.3% (Доступно: 109523.2 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109523.7 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109523.7 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.37 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - Использование памяти: 16.3% (Доступно: 109537.0 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - --- Сохранение файлов сопоставлений ---
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109536.6 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109536.5 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.17 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - Использование памяти: 16.3% (Доступно: 109500.8 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - CSV сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Подготовка данных сопоставлений... (Group to Portrait)
INFO - Подготовка данных сопоставлений... (Portrait to Group)
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109501.0 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109501.0 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.25 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 40 имен.
INFO - Использование памяти: 16.3% (Доступно: 109518.2 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Номер_01'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109518.1 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 16.3% (Доступно: 109518.1 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.27 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 15.0% (Доступно: 111232.2 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - INFO: Анализ keypoints...
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 15.0% (Доступно: 111231.5 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 15.0% (Доступно: 111231.5 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Анализ keypoints завершен.
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - INFO: Генерация HTML...
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - INFO: Генерация HTML завершена.
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.37 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 14.7% (Доступно: 111521.0 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - ==== Кластеризация и сопоставление завершены успешно ====
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 14.7% (Доступно: 111520.8 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 14.7% (Доступно: 111520.7 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.35 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 14.8% (Доступно: 111456.5 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111456.8 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111456.9 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.21 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 14.8% (Доступно: 111465.2 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111465.1 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111465.1 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.26 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 14.8% (Доступно: 111473.2 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111473.0 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111472.9 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.23 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 14.8% (Доступно: 111483.1 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111483.5 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111483.5 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.29 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 14.8% (Доступно: 111486.2 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111484.8 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111484.8 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.30 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 14.8% (Доступно: 111473.6 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111473.2 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111473.2 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.14 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 14.8% (Доступно: 111467.9 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111468.2 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111468.3 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.29 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 14.8% (Доступно: 111398.0 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111483.3 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111483.2 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.21 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 14.8% (Доступно: 111465.2 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111466.7 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111466.8 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.31 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 14.8% (Доступно: 111493.6 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111489.4 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111489.4 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.27 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 14.8% (Доступно: 111482.2 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111482.7 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 14.8% (Доступно: 111482.9 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.32 секунд.
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 14.9% (Доступно: 111373.7 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 14.9% (Доступно: 111374.0 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 14.9% (Доступно: 111374.1 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.31 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 13.8% (Доступно: 112779.4 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - ========== Запуск анализа ключевых точек ==========
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Начало анализа ключевых точек для portrait данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json).
INFO - Использование памяти: 13.8% (Доступно: 112779.0 MB, Всего: 130808.9 MB)
INFO - Обработка 4 файлов типа 'portrait'...
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных portrait JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Начало анализа ключевых точек для group данных (G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json).
INFO - Использование памяти: 13.8% (Доступно: 112779.0 MB, Всего: 130808.9 MB)
INFO - Обработка 2 файлов типа 'group'...
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0.
INFO - Сохранение обновленных group JSON данных...
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 12.31 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 13.7% (Доступно: 112919.5 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.35 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Использование памяти: 13.8% (Доступно: 112729.7 MB, Всего: 130808.9 MB)
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Анализ ключевых точек завершен ==========
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.10 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.11 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.21 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.15 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - INFO: Создание XMP отключено.
INFO - INFO: Перемещение/копирование отключено.
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.20 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - ========== Запуск генерации HTML-отчета ==========
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - ========== Генерация HTML-отчета завершена ==========
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.04 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - Jinja2 окружение настроено. Шаблоны ищутся в: D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\fc_lib
INFO - Загрузка JSON-файлов для отчёта...
INFO - Данные сопоставлений загружены из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches_portrait_to_group.json
INFO - Подготовка данных для HTML-отчета...
INFO - Подготовка данных портретных кластеров...
INFO - Подготовлены данные для 1 портретных кластеров (включая шум).
INFO - Подготовка данных сопоставлений...
INFO - Подготовлены данные сопоставлений для 1 портретных кластеров.
INFO - Генерация визуализации эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Извлечение метаданных для визуализации из JSON...
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнение снижения размерности методом: PCA...
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.16 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Выполнена PCA с n_components=2.
INFO - Снижение размерности завершено.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.24 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - HTML код визуализации сгенерирован.
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (<3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.14 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Копирование вспомогательных файлов отчета в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.15 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.33 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.26 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.29 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.23 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.25 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.22 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.21 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO - Портреты='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_portrait_faces.json'
INFO - Группы='G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\info_group_faces.json'
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.14 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - JsonDataManager инициализирован с путями:
INFO -   - Портретные фотографии: <i>'info_portrait_faces.json'</i>
INFO -   - Групповые фотографии: <i>'info_group_faces.json'</i>
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружено 4(портреты) и 2 (групповые фото) записи.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.29 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - <b>JsonDataManager инициализирован с путями:</b>
INFO -   - Портретные фотографии: <i>info_portrait_faces.json</i>
INFO -   - Групповые фотографии: <i>info_group_faces.json</i>
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\ШТарб_9_1\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Capture'), WindowsPath('G:/2026_Capture_One_Session/ШТарб_9_1/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\ШТарб_9_1\children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружены данные для <b>4</b> портретных и <b>2</b> групповых фотографий.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3049) присвоено имя: 'Будаева Диана'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\ШТарб_9_1\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.46 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - <b>JsonDataManager инициализирован с путями:</b>
INFO -   - Портретные фотографии: <i>info_portrait_faces.json</i>
INFO -   - Групповые фотографии: <i>info_group_faces.json</i>
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\Ш38_4класс\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  1080 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 1080 (Портретов: 777, Групповых: 303).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/Ш38_4класс/Capture'), WindowsPath('G:/2026_Capture_One_Session/Ш38_4класс/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\Ш38_4класс\children.txt: 37 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружены данные для <b>777</b> портретных и <b>303</b> групповых фотографий.
INFO - Загружено 777 эмбеддинга(ов) и 777 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\_Embeddings
INFO - Загружено 704 эмбеддинга(ов) и 704 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\_Embeddings
INFO - Кластеризация 777 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 38 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37]
INFO - Кластеру 0 (min_num=6036) присвоено имя: 'Балбарова Адиса'
INFO - Кластеру 1 (min_num=6050) присвоено имя: 'Борисова Ксения'
INFO - Кластеру 2 (min_num=6070) присвоено имя: 'Брычёва Кристина'
INFO - Кластеру 3 (min_num=6094) присвоено имя: 'Галсанова Мария'
INFO - Кластеру 4 (min_num=6117) присвоено имя: 'Гомбоев Никита'
INFO - Кластеру 5 (min_num=6141) присвоено имя: 'Гордеев Ярослав'
INFO - Кластеру 6 (min_num=6158) присвоено имя: 'Гульков Валерий'
INFO - Кластеру 7 (min_num=6175) присвоено имя: 'Гуруев Арсалан'
INFO - Кластеру 8 (min_num=6191) присвоено имя: 'Данилова Карина'
INFO - Кластеру 9 (min_num=6207) присвоено имя: 'Денисова Ксения'
INFO - Кластеру 10 (min_num=6226) присвоено имя: 'Дядюхина Ангелина'
INFO - Кластеру 11 (min_num=6245) присвоено имя: 'Евсеев Сергей'
INFO - Кластеру 12 (min_num=6261) присвоено имя: 'Ефимов Денис'
INFO - Кластеру 13 (min_num=6279) присвоено имя: 'Змушко Алина'
INFO - Кластеру 14 (min_num=6295) присвоено имя: 'Кафидов Иван'
INFO - Кластеру 15 (min_num=6314) присвоено имя: 'Лапшакова Дмитрий'
INFO - Кластеру 16 (min_num=6331) присвоено имя: 'Лапшакова Надежда'
INFO - Кластеру 17 (min_num=6351) присвоено имя: 'Мехтиев Садиг'
INFO - Кластеру 18 (min_num=6372) присвоено имя: 'Павлюченко Карина'
INFO - Кластеру 19 (min_num=6389) присвоено имя: 'Пежемская Валерия'
INFO - Кластеру 20 (min_num=6410) присвоено имя: 'Пежемская Кристина'
INFO - Кластеру 21 (min_num=6430) присвоено имя: 'Полуянов Иван'
INFO - Кластеру 22 (min_num=6448) присвоено имя: 'Попов Руслан'
INFO - Кластеру 23 (min_num=6474) присвоено имя: 'Попова Таисия'
INFO - Кластеру 24 (min_num=6493) присвоено имя: 'Райкова Анжелика'
INFO - Кластеру 25 (min_num=6524) присвоено имя: 'Ринчинова Снежанна'
INFO - Кластеру 26 (min_num=6547) присвоено имя: 'Савчук Милана'
INFO - Кластеру 27 (min_num=6568) присвоено имя: 'Смирнов Павел'
INFO - Кластеру 28 (min_num=6587) присвоено имя: 'Столярова Милена'
INFO - Кластеру 29 (min_num=6609) присвоено имя: 'Страдзе Мария'
INFO - Кластеру 30 (min_num=6639) присвоено имя: 'Сысоев Артем'
INFO - Кластеру 31 (min_num=6657) присвоено имя: 'Тихонов Семён'
INFO - Кластеру 32 (min_num=6680) присвоено имя: 'Трифонова Дарья'
INFO - Кластеру 33 (min_num=6698) присвоено имя: 'Тютрин Арсений'
INFO - Кластеру 34 (min_num=6726) присвоено имя: 'Федосеева Александра'
INFO - Кластеру 35 (min_num=6748) присвоено имя: 'Хромых Кристина'
INFO - Кластеру 36 (min_num=6765) присвоено имя: 'Юрьев Данил'
INFO - Не хватило имен в списке, кластеру 37 (min_num=6801) присвоено имя: Unknown_1
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 777 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 38 кластеров...
INFO - Вычислено центроидов: 38
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (38 портр. x 704 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 35 сопоставлений портретных и групповых кластеров
INFO - Обновлено 704 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (35 кластеров): G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 777 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 704 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 38 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 35 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 777 эмбеддинга(ов) и 777 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\_Embeddings
INFO - Подготовлено 777 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=20.45, Медианный=20.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 127.47 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - <b>JsonDataManager инициализирован с путями:</b>
INFO -   - Портретные фотографии: <i>info_portrait_faces.json</i>
INFO -   - Групповые фотографии: <i>info_group_faces.json</i>
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\Ш38_4класс\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/Ш38_4класс/Capture'), WindowsPath('G:/2026_Capture_One_Session/Ш38_4класс/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\Ш38_4класс\children.txt: 37 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружены данные для <b>4</b> портретных и <b>2</b> групповых фотографий.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Балбарова Адиса'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\Ш38_4класс\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 12.51 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - <b>JsonDataManager инициализирован с путями:</b>
INFO -   - Портретные фотографии: <i>info_portrait_faces.json</i>
INFO -   - Групповые фотографии: <i>info_group_faces.json</i>
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\Ш38_5класс\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/Ш38_5класс/Capture'), WindowsPath('G:/2026_Capture_One_Session/Ш38_5класс/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\Ш38_5класс\children.txt: 10 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружены данные для <b>4</b> портретных и <b>2</b> групповых фотографий.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Анисимова Василина'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 12.88 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - <b>JsonDataManager инициализирован с путями:</b>
INFO -   - Портретные фотографии: <i>info_portrait_faces.json</i>
INFO -   - Групповые фотографии: <i>info_group_faces.json</i>
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\Ш38_5класс\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/Ш38_5класс/Capture'), WindowsPath('G:/2026_Capture_One_Session/Ш38_5класс/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\Ш38_5класс\children.txt: 7 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружены данные для <b>4</b> портретных и <b>2</b> групповых фотографий.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Анисимова Василина'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 12.86 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - <b>JsonDataManager инициализирован с путями:</b>
INFO -   - Портретные фотографии: <i>info_portrait_faces.json</i>
INFO -   - Групповые фотографии: <i>info_group_faces.json</i>
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\Ш38_5класс\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/Ш38_5класс/Capture'), WindowsPath('G:/2026_Capture_One_Session/Ш38_5класс/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\Ш38_5класс\children.txt: 7 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружены данные для <b>4</b> портретных и <b>2</b> групповых фотографий.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Анисимова Василина'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.14 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - <b>JsonDataManager инициализирован с путями:</b>
INFO -   - Портретные фотографии: <i>info_portrait_faces.json</i>
INFO -   - Групповые фотографии: <i>info_group_faces.json</i>
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\Ш38_5класс\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/Ш38_5класс/Capture'), WindowsPath('G:/2026_Capture_One_Session/Ш38_5класс/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\Ш38_5класс\children.txt: 7 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружены данные для <b>4</b> портретных и <b>2</b> групповых фотографий.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Анисимова Василина'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 12.32 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - <b>JsonDataManager инициализирован с путями:</b>
INFO -   - Портретные фотографии: <i>info_portrait_faces.json</i>
INFO -   - Групповые фотографии: <i>info_group_faces.json</i>
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\Ш38_5класс\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/Ш38_5класс/Capture'), WindowsPath('G:/2026_Capture_One_Session/Ш38_5класс/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\Ш38_5класс\children.txt: 7 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружены данные для <b>4</b> портретных и <b>2</b> групповых фотографий.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Анисимова Василина'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\Ш38_5класс\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.27 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - <b>JsonDataManager инициализирован с путями:</b>
INFO -   - Портретные фотографии: <i>info_portrait_faces.json</i>
INFO -   - Групповые фотографии: <i>info_group_faces.json</i>
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\Ш38_11класс\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/Ш38_11класс/Capture'), WindowsPath('G:/2026_Capture_One_Session/Ш38_11класс/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\Ш38_11класс\children.txt: 6 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружены данные для <b>4</b> портретных и <b>2</b> групповых фотографий.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Васильев Андрей'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 12.68 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - <b>JsonDataManager инициализирован с путями:</b>
INFO -   - Портретные фотографии: <i>info_portrait_faces.json</i>
INFO -   - Групповые фотографии: <i>info_group_faces.json</i>
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\Ш38_11класс\Capture
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/Ш38_11класс/Capture'), WindowsPath('G:/2026_Capture_One_Session/Ш38_11класс/Output/Analysis/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\Ш38_11класс\children.txt: 6 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружены данные для <b>4</b> портретных и <b>2</b> групповых фотографий.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3046) присвоено имя: 'Васильев Андрей'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 12.08 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - <b>JsonDataManager инициализирован с путями:</b>
INFO -   - Портретные фотографии: <i>info_portrait_faces.json</i>
INFO -   - Групповые фотографии: <i>info_group_faces.json</i>
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_STUDIO\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_STUDIO\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\Ш38_11класс\Capture\STUDIO
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/Ш38_11класс/Capture/STUDIO'), WindowsPath('G:/2026_Capture_One_Session/Ш38_11класс/Output/Analysis_STUDIO/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\Ш38_11класс\STUDIO_children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружены данные для <b>4</b> портретных и <b>2</b> групповых фотографий.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_STUDIO\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_STUDIO\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Анисимова Василина'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_STUDIO\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_STUDIO\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_STUDIO\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_STUDIO\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_STUDIO\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_STUDIO\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_STUDIO\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 12.69 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - <b>JsonDataManager инициализирован с путями:</b>
INFO -   - Портретные фотографии: <i>info_portrait_faces.json</i>
INFO -   - Групповые фотографии: <i>info_group_faces.json</i>
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_STUDIO\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_STUDIO\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\Ш38_11класс\Capture\STUDIO
ERROR - Ошибка сканирования папки G:\2026_Capture_One_Session\Ш38_11класс\Capture\STUDIO: [WinError 3] Системе не удается найти указанный путь: 'G:\\2026_Capture_One_Session\\Ш38_11класс\\Capture\\STUDIO'
ERROR - Этап 1 (Обработка изображений / Сохранение эмбеддингов) завершился с ошибками.
ERROR - Этап 1: Анализ изображений и сбор данных завершился с ошибкой.
ERROR - ERROR: Этап 1: Анализ изображений и сбор данных завершился с ошибкой.
CRITICAL - Критическая ошибка во время выполнения run_full_processing: Этап 1: Анализ изображений и сбор данных завершился с ошибкой.
Traceback (most recent call last):
  File "D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\main.py", line 223, in run_full_processing
    raise RuntimeError(
RuntimeError: Этап 1: Анализ изображений и сбор данных завершился с ошибкой.

CRITICAL - CRITICAL: Критическая ошибка во время выполнения run_full_processing: Этап 1: Анализ изображений и сбор данных завершился с ошибкой.
Traceback (most recent call last):
  File "D:\WORK_PYTHON2025\PySM\scripts\Workflow\wf_raw_analysis\main.py", line 223, in run_full_processing
    raise RuntimeError(
RuntimeError: Этап 1: Анализ изображений и сбор данных завершился с ошибкой.

INFO - [ONNXManager] Завершение работы. Освобождение 0 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: НЕУДАЧА
INFO - Время выполнения: 0.01 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - <b>JsonDataManager инициализирован с путями:</b>
INFO -   - Портретные фотографии: <i>info_portrait_faces.json</i>
INFO -   - Групповые фотографии: <i>info_group_faces.json</i>
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\Ш38_11класс\Capture\PORTRAIT
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/Ш38_11класс/Capture/PORTRAIT'), WindowsPath('G:/2026_Capture_One_Session/Ш38_11класс/Output/Analysis_PORTRAIT/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\Ш38_11класс\PORTRAIT_children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружены данные для <b>4</b> портретных и <b>2</b> групповых фотографий.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3025) присвоено имя: 'Анисимова Василина'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.14 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - <b>JsonDataManager инициализирован с путями:</b>
INFO -   - Портретные фотографии: <i>info_portrait_faces.json</i>
INFO -   - Групповые фотографии: <i>info_group_faces.json</i>
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\Ш38_11класс\Capture\PORTRAIT
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/Ш38_11класс/Capture/PORTRAIT'), WindowsPath('G:/2026_Capture_One_Session/Ш38_11класс/Output/Analysis_PORTRAIT/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\Ш38_11класс\PORTRAIT_children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружены данные для <b>4</b> портретных и <b>2</b> групповых фотографий.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Анисимова Василина'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\Ш38_11класс\Output\Analysis_PORTRAIT\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 7.09 секунд.<br>
INFO - Уровень логирования: INFO. Файл: face_processing.log.
INFO - Конфигурация успешно загружена, переопределена и провалидирована.
INFO - Доступные провайдеры ONNX: ['TensorrtExecutionProvider', 'CUDAExecutionProvider', 'CPUExecutionProvider']
INFO - Путь к кэшу TensorRT: D:\WORK_PYTHON2025\PySM\_BIN\TensorRT_cache
INFO - [ONNXManager] Инициализирован с провайдером: TensorrtExecutionProvider
INFO - [AttributeAnalyzer] Загружены модели: 'gender', 'emotion', 'age', 'eyeblink', 
INFO - Обработчик AttributeAnalyzer активирован.
INFO - <b>JsonDataManager инициализирован с путями:</b>
INFO -   - Портретные фотографии: <i>info_portrait_faces.json</i>
INFO -   - Групповые фотографии: <i>info_group_faces.json</i>
INFO - Папка для сохранения эмбеддингов: G:\2026_Capture_One_Session\Ш56_1класс\Output\Analysis_PORTRAIT\_Embeddings
INFO - Сохранение обработанных JPG включено в: G:\2026_Capture_One_Session\Ш56_1класс\Output\Analysis_PORTRAIT\_JPG
INFO - Обработка папки: G:\2026_Capture_One_Session\Ш56_1класс\Capture\PORTRAIT
INFO - Режим обработки RAW ['.arw', '.cr2', '.cr3', '.nef']. Найдено  6 изображений для обработки
INFO - Инициализация FaceAnalysis с провайдером 'TensorrtExecutionProvider'...
INFO - Подготовка модели FaceAnalysis...
INFO - Модель FaceAnalysis успешно инициализирована. Провайдер: TensorrtExecutionProvider.
INFO - FaceDetector успешно инициализирован (ленивая инициализация).
INFO - Используется 8 потоков для обработки изображений.
INFO - Обработано файлов с лицами: 6 (Портретов: 4, Групповых: 2).
INFO - Очистка детектора лиц...
INFO - Детектор лиц и связанные ресурсы очищены.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Папки для поиска файлов для перемещения/копирования: [WindowsPath('G:/2026_Capture_One_Session/Ш56_1класс/Capture/PORTRAIT'), WindowsPath('G:/2026_Capture_One_Session/Ш56_1класс/Output/Analysis_PORTRAIT/_JPG')]
INFO - Загружен список детей из G:\2026_Capture_One_Session\Ш56_1класс\PORTRAIT_children.txt: 5 имен.
INFO - Загрузка JSON данных (метаданные)...
INFO - Загружены данные для <b>4</b> портретных и <b>2</b> групповых фотографий.
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш56_1класс\Output\Analysis_PORTRAIT\_Embeddings
INFO - Загружено 5 эмбеддинга(ов) и 5 индекса(ов) типа 'group' из G:\2026_Capture_One_Session\Ш56_1класс\Output\Analysis_PORTRAIT\_Embeddings
INFO - Кластеризация 4 эмбеддингов типа 'portrait'...
INFO - Используется DBSCAN с eps=0.25, min_samples=1, metric=cosine
INFO - Получено 1 кластеров и 0 шумовых точек
INFO - Определение порядка кластеров по 4-значным номерам в именах файлов...
INFO - Определен порядок кластеров для присвоения имен: [0]
INFO - Кластеру 0 (min_num=3033) присвоено имя: 'Васильев Андрей'
INFO - Обновление JSON данных для портретов метками кластеров и именами...
INFO - Обновлено 4 портретных записей (валидные кластеры), ошибок: 0.
INFO - Вычисление центроидов для 1 кластеров...
INFO - Вычислено центроидов: 1
INFO - Сохранение JSON файлов после обновления данных.
INFO - Сопоставление с порогом 0.2500 (metric=cosine).
INFO - Вычисление матрицы расстояний (1 портр. x 5 групп.)...
INFO - Поиск совпадений ниже порога 0.2500...
INFO - Найдено 1 сопоставлений портретных и групповых кластеров
INFO - Обновлено 5 записей в групповом JSON. Ошибок: 0.
INFO - Сохранение JSON файлов после обновления данных.
INFO - Файл сопоставлений сохранен (1 кластеров): G:\2026_Capture_One_Session\Ш56_1класс\Output\Analysis_PORTRAIT\matches.csv
INFO - Json файлы сопоставления (Group to Portrait) и (Portrait to Group) сохранены
INFO - - Кластеризация и сопоставление завершены успешно
INFO - Анализ ключевых точек для портретных данных (info_portrait_faces.json)
INFO - Анализ 4 лиц типа 'portrait' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш56_1класс\Output\Analysis_PORTRAIT\statistics_info_portrait_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш56_1класс\Output\Analysis_PORTRAIT\recommendations_info_portrait_faces.txt
INFO - Анализ ключевых точек для групповых данных (info_group_faces.json)
INFO - Анализ 5 лиц типа 'group' завершен. Ошибок обновления JSON: 0. Данные сохранены
INFO - Статистика анализа ключевых точек сохранена в G:\2026_Capture_One_Session\Ш56_1класс\Output\Analysis_PORTRAIT\statistics_info_group_faces.json
INFO - Рекомендации сохранены в G:\2026_Capture_One_Session\Ш56_1класс\Output\Analysis_PORTRAIT\recommendations_info_group_faces.txt
INFO - Загрузка JSON-файлов для отчёта...
INFO - Подготовка данных для HTML-отчета...
INFO - Данные для 1 портретных кластеров (включая шум) готовы.
INFO - Данные сопоставлений для 1 портретных кластеров готовы.
INFO - Визуализация эмбеддингов... (интерактивная, Plotly)
INFO - Загружено 4 эмбеддинга(ов) и 4 индекса(ов) типа 'portrait' из G:\2026_Capture_One_Session\Ш56_1класс\Output\Analysis_PORTRAIT\_Embeddings
INFO - Подготовлено 4 точек для визуализации.
INFO - Создание интерактивного графика Plotly...
INFO - Статистика кластеров: Средний размер=4.00, Медианный=4.0, Маленьких (3)=0
INFO - Рендеринг HTML-шаблона...
INFO - Вспомогательные файлы отчета успешно скопированы.
INFO - HTML-отчёт сохранён в G:\2026_Capture_One_Session\Ш56_1класс\Output\Analysis_PORTRAIT\face_clustering_report.html
INFO - Обработка завершена. Результаты: info_portrait_faces.json, info_group_faces.json
INFO - [ONNXManager] Завершение работы. Освобождение 4 сессий...
INFO - [ONNXManager] Все сессии ONNX освобождены.
INFO - Итоговый статус: УСПЕХ
INFO - Время выполнения: 12.53 секунд.<br>
