# Руководство по скрипту "Анализ RAW-файлов" (v1.05.03)

## 1. Назначение

Скрипт **"Анализ RAW-файлов"** — это основной и наиболее сложный компонент рабочего процесса. Он выполняет глубокий анализ изображений с использованием нейросетевых моделей.

## 2. Логика работы

При запуске скрипт выполняет следующие действия:

1.  **Загружает конфигурацию:** Использует базовый файл `face_config.toml` (или файл, указанный в параметре `__wf_config`).
2.  **Получает данные из контекста:** Использует значения из контекста, установленные предыдущими скриптами, для заполнения параметров.
3.  **Запускает полный цикл анализа**, который включает в себя:
    -   Поиск лиц на всех изображениях в папке.
    -   Анализ атрибутов каждого лица: пол, возраст, эмоции, направление взгляда.
    -   Кластеризацию (группировку) похожих лиц.
    -   Создание подробного HTML-отчета.
4.  **Отображает прогресс** и ведет подробный лог работы.

## 3. Параметры

Следующие параметры отображаются в графическом интерфейсе, но обычно **заполняются автоматически** другими скриптами через Контекст Коллекции. Они служат для информации и контроля.

-   **`__wf_config`**:
    -   **Назначение:** Путь к файлу конфигурации `.toml`.
    -   **Источник:** По умолчанию используется `face_config.toml` из папки скрипта. Может быть переопределен через контекст.

-   **`__wf_folder_path`**:
    -   **Назначение:** Путь к папке с исходными изображениями для анализа.
    -   **Источник:** Заполняется из переменной контекста, например, `capture_path`, установленной скриптом "Импорт RAW".

-   **`__wf_output_path`**:
    -   **Назначение:** Путь к папке для сохранения результатов анализа.
    -   **Источник:** Заполняется из переменной контекста, например, `session_path`.

-   **`__wf_children_file`**:
    -   **Назначение:** Путь к файлу со списком детей для сопоставления.
    -   **Источник:** Заполняется из контекста, если этот файл был определен в рабочем процессе.

-   **`__wf_log_level`**:
    -   **Назначение:** Позволяет динамически изменить уровень детализации логов.
    -   **Источник:** Может быть установлен в контексте для отладки. Если не задан, используется значение из `.toml` файла.