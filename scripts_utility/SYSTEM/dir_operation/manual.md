# Руководство по использованию скрипта "Перемещение файлов" (v1.05.03)

## 1. Назначение

Скрипт **"Перемещение файлов"** — это мощная и гибкая утилита для выполнения файловых операций. Он позволяет копировать или перемещать содержимое одной папки в другую, используя многопоточность для ускорения процесса.

Ключевой особенностью является поддержка **динамических путей**, что позволяет создавать очень гибкие и переиспользуемые рабочие процессы.

## 2. Параметры

-   **Исходная директория** (`do_source_dir`):
    -   Путь к папке, откуда нужно взять файлы. **Поддерживает шаблоны.**

-   **Директория назначения** (`do_dest_dir`):
    -   Путь к папке, куда нужно положить файлы. **Поддерживает шаблоны.**

-   **Режим работы** (`do_mode`):
    -   `copy` (по умолчанию): Файлы будут скопированы, оригиналы останутся на месте.
    -   `move`: Файлы будут перемещены. **Внимание:** если операция завершится без ошибок, исходная папка будет удалена!

-   **Действие при конфликте** (`do_on_conflict`):
    -   Определяет, что делать, если в папке назначения уже есть файл с таким же именем.
    -   `skip` (по умолчанию): Пропустить этот файл, ничего с ним не делать.
    -   `overwrite`: Перезаписать существующий файл новым.
    -   `rename`: Оставить существующий файл, а новый сохранить с добавлением числового суффикса (например, `photo (1).jpg`).

-   **Копировать корневую папку** (`do_copy_base_folder`):
    -   **Выключено (по умолчанию):** Содержимое `do_source_dir` копируется напрямую в `do_dest_dir`.
    -   **Включено:** Внутри `do_dest_dir` создается папка с именем `do_source_dir`, и уже в нее копируется содержимое.

-   **Паттерны для включения** (`do_include`):
    -   Позволяет указать, какие именно файлы нужно обработать. Используется стандартный glob-синтаксис. Можно указать несколько паттернов, каждый с новой строки.
    -   `*` (по умолчанию): Все файлы.
    -   `*.jpg`: Только файлы с расширением `.jpg`.
    -   `report_*.docx`: Файлы, начинающиеся с `report_` и с расширением `.docx`.

-   **Количество потоков** (`do_threads`):
    -   Определяет, сколько файлов могут обрабатываться одновременно. Увеличение этого значения может значительно ускорить процесс на большом количестве мелких файлов.

## 3. Динамическое формирование путей (Шаблоны)

Это самая мощная функция скрипта. В полях `Исходная директория` и `Директория назначения` вы можете использовать плейсхолдеры вида `{имя_переменной}`. При запуске скрипт автоматически заменит их на значения из Контекста Коллекции.

### Примеры использования:

-   **Простой путь:**
    `D:\PhotoArchive\2024`

-   **Путь с использованием переменной `user_name` из контекста:**
    `C:\Users\{user_name}\Desktop\New`

-   **Сложный композитный путь из нескольких переменных:**
    `{project_root}\{project_name}\Exports\Final`

-   **Воспроизведение "специальной логики" без редактирования кода:**
    `{session_path}/{session_name}/Output/{session_name}`

## 4. Логика работы и коды выхода

-   **Код выхода `0` (Успех):**
    -   Скрипт завершается с этим кодом, если все операции были выполнены успешно или пропущены (при `do_on_conflict: skip`).
    -   Следующий скрипт в цепочке будет запущен.

-   **Код выхода `1` (Ошибка):**
    -   Скрипт завершается с этим кодом, если в процессе произошла хотя бы одна ошибка (например, не удалось получить доступ к файлу) или если исходная директория не найдена.
    -   **Выполнение всей цепочки скриптов будет немедленно остановлено.**