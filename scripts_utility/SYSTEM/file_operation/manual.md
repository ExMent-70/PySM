# Руководство по скрипту "Операции с файлами" (1.05.03)

## 1. Назначение

Скрипт **"Операции с файлами"** является инструментом для выполнения точечных действий с одним конкретным **файлом** в вашей файловой системе. Он позволяет копировать, перемещать, переименовывать или удалять файлы в рамках ваших рабочих процессов.

**Внимание:** Этот скрипт не предназначен для работы с папками или массовой обработки содержимого. Для этих целей используйте скрипты "Операции с папками" и "Массовая передача данных".

## 2. Параметры

Все параметры этого скрипта начинаются с префикса `fo_` (File Operation) для избежания конфликтов.

### 2.1. Основные параметры

-   **Тип операции** (`fo_operation`):
    -   **Обязательный параметр.** Определяет, какое действие будет выполнено.
    -   **Варианты:**
        -   `copy`: Копировать файл.
        -   `move`: Переместить файл в другую папку.
        -   `rename`: Переименовать файл (может включать перемещение).
        -   `delete`: Удалить файл.

-   **Исходный файл** (`fo_source_path`):
    -   Путь к файлу, над которым производится действие. При настройке в PySM будет показан **диалог выбора файла**.

-   **Путь назначения** (`fo_destination_path`):
    -   Новый путь или местоположение для файла. Требуется для операций `copy`, `move`, `rename`. PySM также покажет **диалог выбора файла** (где можно будет ввести новое имя).

### 2.2. Дополнительные опции

-   **Перезаписать** (`fo_overwrite`):
    -   Если флаг установлен, скрипт перезапишет файл в `пути назначения`, если он уже существует. В противном случае операция завершится с ошибкой.

-   **Создавать родительские папки** (`fo_create_parents`):
    -   Если флаг установлен и `путь назначения` указывает на несуществующую структуру папок, она будет создана автоматически.

### 2.3. Требования к параметрам для каждой операции

| Операция | `fo_source_path` | `fo_destination_path` |
| :--- | :---: | :---: |
| `copy` | **Требуется** | **Требуется** |
| `move` | **Требуется** | **Требуется** |
| `rename` | **Требуется** | **Требуется** |
| `delete` | **Требуется** | Не используется |

## 3. Динамическое формирование путей

Вы можете использовать плейсхолдеры вида `{имя_переменной}` в полях путей. Это полезно, если путь генерируется другим скриптом. В этом случае PySM не покажет диалог, а подставит значение из контекста.

**Пример:**
- **Задача:** Скопировать созданный отчет в папку "Архив".
- `Тип операции`: `copy`
- `Исходный файл`: `{path_to_report}` (переменная из контекста)
- `Путь назначения`: `D:/Archive/`

## 4. Логика работы и коды выхода

-   **Код выхода `0` (Успех):** Операция выполнена без ошибок. Выполнение цепочки продолжается.
-   **Код выхода `1` (Ошибка):** Произошла ошибка (файл не найден, нет прав, и т.д.). Выполнение цепочки будет **остановлено**.