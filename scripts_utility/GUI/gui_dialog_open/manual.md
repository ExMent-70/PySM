# Руководство по использованию скрипта "Выбор файла или папки"

## 1. Назначение

Скрипт **"Выбор файла или папки"** предоставляет пользователю стандартный системный интерфейс для выбора пути в файловой системе. Это позволяет сделать другие скрипты более гибкими, давая возможность пользователю во время выполнения указать, с какими данными работать (например, выбрать исходную папку с фотографиями или указать путь к файлу конфигурации).

Выбранный путь сохраняется в Контекст Коллекции для использования в последующих скриптах.

## 2. Параметры

Скрипт имеет следующие настраиваемые параметры в интерфейсе PySM:

-   **Имя переменной пути** (`dlg_open_var`):
    -   **Описание:** Имя переменной, в которую будет сохранен выбранный путь. Это обязательное поле.
    -   **Значение по умолчанию:** `{dlg_open_user_var}`.

-   **Тип диалогового окна** (`dialog_type`):
    -   **Описание:** Определяет, что именно сможет выбрать пользователь: файл или папку.
    -   **Значение по умолчанию:** `file`.
    -   **Варианты:** `file` (выбор файла), `directory` (выбор папки).

-   **Заголовок окна** (`title`):
    -   **Описание:** Текст в заголовке окна, поясняющий пользователю, что нужно выбрать.
    -   **Значение по умолчанию:** `Выберите путь`.

-   **Фильтр файлов** (`filter`):
    -   **Описание:** Позволяет ограничить типы файлов, которые можно выбрать. **Этот параметр работает только тогда, когда "Тип диалогового окна" установлен в `file`**.
    -   **Примеры:**
        -   `Все файлы (*.*)` (по умолчанию)
        -   `Изображения (*.png *.jpg *.bmp)`
        -   `Текстовые файлы (*.txt);;Документы CSV (*.csv)`
    -   **Значение по умолчанию:** `Все файлы (*.*)`.

## 3. Логика работы

### 3.1. Сохранение результата

Если пользователь выбирает файл или папку и нажимает "Открыть" ("Выбор папки"), скрипт сохраняет полный абсолютный путь к выбранному объекту в **Контекст Коллекции**. Имя переменной для сохранения задается в параметре `Имя переменной пути`.

### 3.2. Управление потоком выполнения (коды выхода)

-   **Код выхода `0` (Успех):**
    -   Скрипт завершается с этим кодом, если пользователь выбрал путь и подтвердил свой выбор.
    -   Следующий скрипт в цепочке будет запущен.

-   **Код выхода `1` (Отмена):**
    -   Скрипт завершается с этим кодом, если пользователь закрыл диалоговое окно без выбора (нажал "Отмена" или системную кнопку закрытия).
    -   **Выполнение всей цепочки скриптов будет немедленно остановлено.**

## 4. Пример использования

**Задача:** Дать пользователю возможность самому выбрать папку с исходными фотографиями для их последующей обработки.

1.  В начало цепочки добавляется скрипт **"Выбор файла или папки"**.
2.  В его параметрах указывается:
    -   `Имя переменной пути`: `source_photo_dir`
    -   `Тип диалогового окна`: `directory`
    -   `Заголовок`: `Выберите папку с исходными фотографиями`
3.  Следующим в цепочке идет скрипт, который обрабатывает фотографии. В параметрах этого скрипта (например, в поле "Путь к папке") указывается ссылка на переменную контекста: `{source_photo_dir}`.
4.  При запуске пользователь сначала увидит диалог выбора папки. После выбора PySM подставит этот путь в параметры второго скрипта, и тот начнет обработку. Если пользователь отменит выбор, обработка не начнется.