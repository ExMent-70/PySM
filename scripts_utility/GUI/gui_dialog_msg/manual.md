# Руководство по использованию скрипта "Диалоговое окно"

## 1. Назначение

Скрипт **"Диалоговое окно"** предназначен для взаимодействия с пользователем в процессе выполнения цепочки скриптов. Он приостанавливает выполнение и показывает модальное окно с сообщением и кнопками, позволяя пользователю принять решение, которое повлияет на дальнейший ход работы.

Основная задача — задать пользователю вопрос и, в зависимости от ответа, либо продолжить выполнение последовательности, либо прервать его.

## 2. Параметры

Скрипт имеет следующие настраиваемые параметры в интерфейсе PySM:

-   **Имя переменной результата** (`dlg_msg_var`):
    -   **Описание:** Имя переменной, в которую будет сохранен ответ пользователя. Это обязательное поле.
    -   **Значение по умолчанию:** `var_user_choice`.

-   **Тип диалогового окна** (`dlg_msg_type`):
    -   **Описание:** Определяет, какой набор кнопок будет показан пользователю.
    -   **Значение по умолчанию:** `yes_no`.
    -   **Варианты:** `ok`, `yes_no`, `yes_no_cancel`.

-   **Заголовок окна** (`dlg_msg_title`):
    -   **Описание:** Текст в заголовке окна.
    -   **Значение по умолчанию:** `Подтверждение`.

-   **Текст сообщения** (`dlg_msg_message`):
    -   **Описание:** Основной текст вопроса, который будет задан пользователю. Поле является многострочным.
    -   **Значение по умолчанию:** `Вы уверены, что хотите продолжить?`

## 3. Логика работы

### 3.1. Сохранение результата

После того как пользователь нажмет одну из кнопок, скрипт сохранит результат в **Контекст Коллекции** в виде строки. Имя переменной для сохранения задается в параметре `Имя переменной результата`.

Возможные значения:
-   `"ok"`
-   `"yes"`
-   `"no"`
-   `"cancel"`
-   `"unknown"` (если окно было закрыто без нажатия на кнопку, например, крестиком)

### 3.2. Управление потоком выполнения (коды выхода)

Скрипт использует коды завершения для управления дальнейшим выполнением цепочки скриптов в PySM:

-   **Код выхода `0` (Продолжить):**
    -   Скрипт завершается с этим кодом, если пользователь сделал выбор, предполагающий продолжение операции. Следующий скрипт в цепочке будет запущен.
    -   **Условия:**
        -   Нажата кнопка `OK`.
        -   Нажата кнопка `Да`.
        -   Нажата кнопка `Нет` в диалоге `Да / Нет / Отмена`.

-   **Код выхода `1` (Прервать):**
    -   Скрипт завершается с этим кодом, если пользователь решил прервать операцию. **Выполнение всей цепочки скриптов будет остановлено.**
    -   **Условия:**
        -   Нажата кнопка `Нет` в диалоге `Да / Нет`.
        -   Нажата кнопка `Отмена`.
        -   Окно было закрыто системной кнопкой (крестик).

## 4. Пример использования

**Задача:** Перед выполнением длительной операции по обработке файлов спросить у пользователя подтверждение.

1.  В цепочку скриптов первым добавляется скрипт **"Диалоговое окно"**.
2.  В его параметрах указывается:
    -   `Имя переменной результата`: `confirm_processing`
    -   `Тип диалогового окна`: `yes_no`
    -   `Заголовок`: `Подтверждение операции`
    -   `Сообщение`: `Запустить обработку 150 файлов? Это может занять много времени.`
3.  Если пользователь нажмет "Да", скрипт завершится с кодом `0`, и PySM запустит следующий скрипт обработки.
4.  Если пользователь нажмет "Нет", скрипт завершится с кодом `1`, и PySM остановит выполнение.